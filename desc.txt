main.nf assembles KIR haplotypes from PacBio HiFi reads.<br>
align.nf aligns and reports on the raw and/or assembled sequences.

<h2>Assembly</h2>
<b>Input</b> <br>
The input is a directory containing one or more compressed fastq files, each representing one individual. Each file is from PacBio HiFi 99.9% consensus sequences.

<b>Output</b> <br>
Each input file has a correspoding output file with the assembled contigs.

<b>Running</b><br>
Replace 'inDir' with the path to the input files. Replace 'outDir' with the path where the output files should be placed.

<code>    docker run --rm -it -v inDir:/opt/kass/raw -v outDir:/opt/kass/output droeatumn/kass:latest main.nf</code>

The image contains an example: a cA01&tilde;tA01 homozygous individual
(GenBank accession KP420442). Replace 'outDir' with the path where the output files should be placed.<br>
<code>    docker run --rm -it -v outDir:/opt/kass/output droeatumn/kass:latest main.nf --raw /opt/kass/raw/example/

<b>Miscellaneous</b><br>
Hardware<br>
Minimum recommended hardware is 10G memory and 8 cores. More of each helps.
Run time is 1-2 hours per ID, depending on platform, genotype variation, and parallel execution.

<h2>Alignment</h2>
<b>Input</b> <br>
The input is a directory containing a reference sequence in a fasta file along with one or more fasta/fastq files to be aligned to the reference.

<b>Output</b> <br>
Index files are output for the reference fasta.<br>
For each non-reference input file, a sorted bam file, its index, and the unaligned reads are ouput. Also, Qualimap (*qualimap.pdf) and NanoPlot (*NanoPlot-report.html) reports are generated for the alignment and a FastQC report (*fastqc.html) is generated if the input is a fastq file.

<b>Running</b><br>
Replace 'inDir' with the path to the input files. Replace 'outDir' with the path where the output files should be placed. Replace 'threadNum' with the maximum number of threads to use. Replace 'refFasta' with the name of the reference fasta file that is located in the input directory.

<code>    docker run --rm -it -v inDir:/opt/kass/raw -v outDir:/opt/kass/output droeatumn/kass:latest align.nf --threads threadNum --reference refFasta</code>

<h2>Bundled references</h2>
Some references and their indexes are bundled in /opt/kass/input/references/. You can see what is there via:

<code>     docker run --rm -it droeatumn/kass:latest sh</code><br>
At the prompt in the image, type<br>
<code>     ls /opt/kass/input/references</code><br>
<code>     exit</code>

You can copy them to your local file system. Replace 'outDir' with the path where the output files be placed.

<code>     docker run --rm -it -v outDir:/opt/kass/output droeatumn/kass:latest sh</code><br>
<code>     cp -r /opt/kass/input/references /opt/kass/output/</code><br>
<code>     exit</code>

KP420439 and KP420442 are cA01&tilde;tA01. KP420440 is cB01&tilde;tB01.
